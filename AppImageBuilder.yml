version: 1

script:
  - rm -rf ./AppDir || true
  - make install DESTDIR=AppDir

AppDir:
  path: ./AppDir
  app_info:
    id: org.wesnoth.Wesnoth
    name: Battle for Wesnoth
    icon: wesnoth-icon
    version: ${$(grep -o -E 'define\s(VERSION)\s"[[:digit:]]+\.[[:digit:]]+\.[[:digit:]]+[[:graph:]]*"' src/wesconfig.h | grep -o -E '[[:digit:]]+\.[[:digit:]]+\.[[:digit:]]+[^"]*')}
    exec: usr/bin/wesnoth
    exec_args: $@
  apt:
    sources:
    - sourceline: deb https://deb.debian.org/debian bullseye main contrib non-free
    - sourceline: deb https://deb.debian.org/debian bullseye-updates main contrib non-free
    - sourceline: deb https://security.debian.org bullseye-security main contrib non-free
    - sourceline: deb https://deb.debian.org/debian bullseye-backports main contrib non-free
    allow_unauthenticated: true
    arch: amd64
    include:
    - libboost-filesystem1.74.0
    - libboost-iostreams1.74.0
    - libboost-locale1.74.0
    - libboost-program-options1.74.0
    - libboost-random1.74.0
    - libboost-thread1.74.0
    - libc6
    - libfluidsynth2
    - libicu67
    - libinstpatch-1.0-2
    - libmodplug1
    - libopusfile0
    - libreadline8
    - libsdl2-2.0-0
    - libsdl2-image-2.0-0
    - libsdl2-mixer-2.0-0
    - libstdc++6

    exclude:
    - fonts-adf-oldania
    - fonts-dejavu-core
    - fonts-dejavu-extra
    - fonts-droid-fallback
    - fonts-lato
    - gcc-10-base
    - libasound2-data
    - libasound2
    - libasyncns0
    - libblkid1
    - libboost-regex1.74.0
    - libbrotli1
    - libbz2-1.0
    - libcairo2
    - libcom-err2
    - libcrypt1
    - libdatrie1
    - libdbus-1-3
    - libdeflate0
    - libexpat1
    - libffi7
    - libflac8
    - libfontconfig1
    - libfreetype6
    - libfribidi0
    - libgcc-s1
    - libgcrypt20
    - libglib2.0-0
    - libgpg-error0
    - libgraphite2-3
    - libgssapi-krb5-2
    - libharfbuzz0b
    - libjack-jackd2-0
    - libjbig0
    - libjpeg62-turbo
    - libk5crypto3
    - libkeyutils1
    - libkrb5-3
    - libkrb5support0
    - liblz4-1
    - liblzma5
    - libmount1
    - libmpg123-0
    - libnsl2
    - libogg0
    - libopus0
    - libpango-1.0-0
    - libpangocairo-1.0-0
    - libpangoft2-1.0-0
    - libpcre2-8-0
    - libpcre3
    - libpixman-1-0
    - libpng16-16
    - libpulse0
    - libreadline8
    - libsamplerate0
    - libselinux1
    - libsndfile1
    - libssl1.1
    - libsystemd0
    - libthai0
    - libthai-data
    - libtiff5
    - libtinfo6
    - libtirpc-common
    - libtirpc3
    - libuuid1
    - libvorbis0a
    - libvorbisenc2
    - libvorbisfile3
    - libwebp6
    - libwrap0
    - libxcursor1
    - libxext6
    - libxfixes3
    - libxi6
    - libxinerama1
    - libxkbcommon0
    - libxrandr2
    - libxrender1
    - libxss1
    - libxxf86vm1
    - libzstd1
    - readline-common
    - timgm6mb-soundfont
    - xkb-data
    - zlib1g

  files:
    exclude:
    - usr/share/man
    - usr/share/doc/*/README.*
    - usr/share/doc/*/changelog.*
    - usr/share/doc/*/NEWS.*
    - usr/share/doc/*/TODO.*

AppImage:
  arch: x86_64
  sign-key: None
  update-information: guess
